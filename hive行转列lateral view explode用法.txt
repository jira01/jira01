hive行转列lateral view explode用法
lateral view用于和split, explode等UDTF一起使用，它能够将一行数据拆成多行数据，在此基础上可以对拆分后的数据进行聚合。

问题：

有一个表（表名：book，两个字段：id,desc）

id    　desc

001    书名: 追风筝的人, ISBN编号: 9787208061644, 作者: 卡勒德.胡赛尼

002    书名: 秘密花园, ISBN编号: 9787550252585, 作者: 乔汉娜·贝斯福

需求：

其中desc字段包含了几个参数信息，需把它拆分开来，一行一个参数，结果如下

001    书名: 追风筝的人

001    ISBN编号: 9787208061644

001     作者: 卡勒德.胡赛尼

002    书名: 秘密花园

002    ISBN编号: 9787550252585

002    作者: 乔汉娜·贝斯福

解决办法：

select id,sp from book a  lateral view explode(split(a.desc,‘,‘)) t as sp where 1=1;

id　　   sp

001　　书名: 追风筝的人

001　　ISBN编号: 9787208061644

....

其中sp是拆出来的字段的，结果和需求一样。

非常简练，虽然hive有不能insert,update的缺点，但很多sql语法都支持，不失为大数据分析的一个好工具！

解释一下，from后面是你的表名，在表名后面加lateral view explode。。。（你的行转列sql） ，还必须要起一个别名，我这个字段的别名为sp。然后再看看select后面的 s.*，就是原表的字段，我这里面只有一个字段，且为X，效果就是上面的图片效果了。


注意事项 
写法有点怪，一定不要写错
不要忘记起别名，要不select没列可写
